/**
 * Project Name :- Mineboty
 * Author :- JustaKartik
 * Â© Copyright 2021-2023 Mineboty
 * Powered By Team Ic
 * Partnered By RudraCloud.com
 */

const mineflayer = require('mineflayer') // eslint-disable-line
const navigatePlugin = require('mineflayer-navigate')(mineflayer);
const { pathfinder, Movements, goals: { GoalNear } } = require('mineflayer-pathfinder')
/**
 * @param {mineflayer.Bot} bot // to enable intellisense
 */

module.exports = bot => {
    
    bot.loadPlugin(navigatePlugin);

const RANGE_GOAL = 5 // get within this radius of the player

bot.loadPlugin(pathfinder)
bot.once('spawn', () => {
    const defaultMove = new Movements(bot)
  
    bot.on('chat', (username, message) => {
      if (username === bot.username) return
      if (message !== 'come') return
      const target = bot.players[username]?.entity
      if (!target) {
        bot.chat("I don't see you !")
        return
      }
      const { x: playerX, y: playerY, z: playerZ } = target.position
      bot.chat("coming baby")
      bot.pathfinder.setMovements(defaultMove)
      bot.pathfinder.setGoal(new GoalNear(playerX, playerY, playerZ, RANGE_GOAL))
    })
  })
}